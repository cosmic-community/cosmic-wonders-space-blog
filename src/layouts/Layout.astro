---
// src/layouts/Layout.astro
export interface Props {
  title: string;
  description?: string;
  image?: string;
}

const { title, description = 'Explore the wonders of space through captivating articles and stories', image } = Astro.props;
const bucketSlug = import.meta.env.COSMIC_BUCKET_SLUG as string;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    
    <!-- SEO -->
    <title>{title} | Cosmic Wonders</title>
    <meta name="description" content={description} />
    
    <!-- Open Graph -->
    <meta property="og:title" content={`${title} | Cosmic Wonders`} />
    <meta property="og:description" content={description} />
    <meta property="og:type" content="website" />
    {image && <meta property="og:image" content={image} />}
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={`${title} | Cosmic Wonders`} />
    <meta name="twitter:description" content={description} />
    {image && <meta name="twitter:image" content={image} />}
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet" />
    
    <!-- Console capture script for dashboard debugging -->
    <script src="/dashboard-console-capture.js" is:inline></script>
  </head>
  <body class="min-h-screen bg-gradient-cosmic text-white font-sans antialiased">
    <!-- Star background effect -->
    <div class="fixed inset-0 overflow-hidden pointer-events-none z-0">
      <div class="stars"></div>
    </div>
    
    <div class="relative z-10">
      <slot />
    </div>
    
    <!-- Cosmic Badge -->
    <a
      href={`https://www.cosmicjs.com?utm_source=bucket_${bucketSlug}&utm_medium=referral&utm_campaign=app_badge&utm_content=built_with_cosmic`}
      target="_blank"
      rel="noopener noreferrer"
      id="cosmic-badge"
      class="fixed bottom-5 right-5 flex items-center gap-2 text-white text-sm font-medium no-underline transition-colors duration-200 z-50 rounded-lg shadow-lg px-4 py-3"
      style="background-color: #11171A; width: 180px;"
    >
      <button
        id="cosmic-dismiss"
        class="absolute -top-2 -right-2 w-6 h-6 bg-gray-600 hover:bg-gray-700 text-white rounded-full flex items-center justify-center text-sm font-bold transition-colors duration-200 z-10"
        aria-label="Dismiss badge"
      >
        Ã—
      </button>
      <img 
        src="https://cdn.cosmicjs.com/b67de7d0-c810-11ed-b01d-23d7b265c299-logo508x500.svg" 
        alt="Cosmic Logo" 
        class="w-5 h-5"
      />
      Built with Cosmic
    </a>
    
    <style is:global>
      .stars {
        position: absolute;
        width: 100%;
        height: 100%;
        background-image: 
          radial-gradient(2px 2px at 20px 30px, white, transparent),
          radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
          radial-gradient(1px 1px at 90px 40px, white, transparent),
          radial-gradient(2px 2px at 160px 120px, rgba(255,255,255,0.6), transparent),
          radial-gradient(1px 1px at 230px 80px, white, transparent),
          radial-gradient(2px 2px at 300px 200px, rgba(255,255,255,0.8), transparent),
          radial-gradient(1px 1px at 350px 50px, white, transparent),
          radial-gradient(2px 2px at 400px 150px, rgba(255,255,255,0.7), transparent),
          radial-gradient(1px 1px at 480px 90px, white, transparent),
          radial-gradient(2px 2px at 550px 220px, rgba(255,255,255,0.6), transparent);
        background-repeat: repeat;
        background-size: 600px 300px;
        animation: twinkle 8s ease-in-out infinite;
      }
      
      @keyframes twinkle {
        0%, 100% { opacity: 0.5; }
        50% { opacity: 1; }
      }
      
      .prose h1, .prose h2, .prose h3, .prose h4, .prose h5, .prose h6 {
        color: white;
      }
      
      .prose p, .prose li, .prose ul, .prose ol {
        color: rgba(255, 255, 255, 0.85);
      }
      
      .prose strong {
        color: white;
      }
      
      .prose a {
        color: #a78bfa;
      }
      
      .prose a:hover {
        color: #c4b5fd;
      }
    </style>
    
    <script is:inline>
      // Badge dismiss functionality
      document.addEventListener('DOMContentLoaded', () => {
        const badge = document.getElementById('cosmic-badge');
        const dismissBtn = document.getElementById('cosmic-dismiss');
        
        if (localStorage.getItem('cosmic-badge-dismissed')) {
          if (badge) badge.style.display = 'none';
          return;
        }
        
        if (dismissBtn && badge) {
          dismissBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            badge.style.display = 'none';
            localStorage.setItem('cosmic-badge-dismissed', 'true');
          });
          
          badge.addEventListener('mouseenter', () => {
            badge.style.backgroundColor = '#1a2326';
          });
          
          badge.addEventListener('mouseleave', () => {
            badge.style.backgroundColor = '#11171A';
          });
        }
      });
    </script>
  </body>
</html>